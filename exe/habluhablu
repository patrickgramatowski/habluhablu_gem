#!/usr/bin/env ruby
# frozen_string_literal: true

require "optparse"
require "habluhablu"

args = {}
OptionParser.new do |opts|
  opts.banner = "Generate files including basic phrases translations (using with I18n gem)"

  opts.on("-l", "--language SYMBOL", "Symbol of the language you want to generate file for (en, es, ...).")
  opts.on("-m", "--multi SYMBOLS", "Symbols of languages you want to generate files for (en es pl ar)")
  opts.on("-k", "--keyword KEYWORD", "Add your own keyword for all language files (.yml).")
  opts.on("-s", "--sample FILES", "Add your own sample for language files (.yml).")
end.parse!(into: args)

information = lambda do |param|
  if File.exist?("config/locales/#{param}.yml")
    puts "..."
    sleep 0.5
    puts "Everything was generated successfully!"
  else
    puts "Something went wrong!"
  end
end

if args[:sample].nil?
  if args[:multi].nil?
    if args[:keyword].nil?
      Habluhablu.hablu(args[:language])
      information.call(args[:language])
    else
      Habluhablu.keyword(args[:keyword])
      puts "..."
      sleep 0.5
      puts "Everything was added successfully!"
    end
  else
    languages_array = args[:multi].split("_")
    languages_array.each do |language|
      Habluhablu.hablu(language)
    end
    information.call(languages_array.last)
  end
else
  Habluhablu.render_sample(args[:sample])
  information.call("sample")
end
